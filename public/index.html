<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    <!--
      manifest.json provides metadata used when your web app is added to the
      homescreen on Android. See https://developers.google.com/web/fundamentals/engage-and-retain/web-app-manifest/
    -->
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/favicon.ico">
    <title>Firebase Skeleton App</title>
    <style type="text/css">
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background-color: #eceff1;
      font-family: 'Google Sans',sans-serif;
    }

    .app {
      text-align: center;
    }

    .header {
      background-color: white;
      height: 150px;
      padding: 20px;
    }

    h1 {
      color: rgba(0,0,0,0.87);
      font-size: 30px;
      font-weight: 400;
      line-height: 40px;
    }

    h2 {
      color: rgba(0,0,0,0.54);
      font-size: 16px;
      line-height: 24px;
    }
    </style>
  </head>
  <body>
    <div class="app">
      <header class="header">
        <h1>Welcome to the Firebase Skeleton App!</h1>
        <h2>The smallest app we could make using auth, realtime database, and hosting.</h2>
      </header>
      <button id="sign-in">Sign in with Google</button>
      <h2 id="welcome-message"></h2>
      <img src="/skeleton.png" alt="Skeleton">
    </div>
    <!-- Import and configure the Firebase SDK -->
    <!-- These scripts are made available when the app is served or deployed on Firebase Hosting -->
    <!-- If you do not serve/host your project using Firebase Hosting see https://firebase.google.com/docs/web/setup -->
    <script src="/__/firebase/5.0.4/firebase-app.js"></script>
    <script src="/__/firebase/5.0.4/firebase-auth.js"></script>
    <script src="/__/firebase/5.0.4/firebase-database.js"></script>
    <script src="/__/firebase/init.js"></script>
    <script type="text/javascript">
    function toggleSignIn() {
      if (!firebase.auth().currentUser) {
        var provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithPopup(provider).then(function (result) {
          var token = result.credential.accessToken;
          var user = result.user;
          document.getElementById('quickstart-oauthtoken').textContent = token;
        }).catch(function (error) {
          console.error(error);
        });
      } else {
        firebase.auth().signOut();
      }
      document.getElementById('sign-in').disabled = true;
    }

    function welcomeMessage(name) {
      return "Welcome " + name + "! You have logged on once."
    }

    function initApp() {
      // Welcome ! You have logged on < span id = "logins" > once</span >.
      firebase.auth().onAuthStateChanged(function (user) {
        if (user) {
          var displayName = user.displayName;
          var uid = user.uid;
          var email = user.email;
          document.getElementById('sign-in').textContent = 'Sign out';
          document.getElementById('welcome-message').textContent = welcomeMessage(displayName);
        } else {
          document.getElementById('sign-in').textContent = 'Sign in with Google';
          document.getElementById('welcome-message').textContent = '';
        }
        document.getElementById('sign-in').disabled = false;
      });
      document.getElementById('sign-in').addEventListener('click', toggleSignIn, false);
    }
    window.onload = function () {
      initApp();
    };
    </script>
  </body>
</html>
